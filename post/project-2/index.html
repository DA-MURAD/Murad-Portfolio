<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Project 2:Profiling and Analyzing the Yelp Dataset With SQL | Murad Farhan</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Data Scientist Role Play: Profiling and Analyzing the Yelp Dataset">
    <meta name="generator" content="Hugo 0.71.0" />
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    
<link rel="stylesheet" href="https://da-murad.github.io/Murad-Portfolio/ananke/css/main.min.css" >



    
    
    
      

    

    
    
    <meta property="og:title" content="Project 2:Profiling and Analyzing the Yelp Dataset With SQL" />
<meta property="og:description" content="Data Scientist Role Play: Profiling and Analyzing the Yelp Dataset" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://da-murad.github.io/Murad-Portfolio/post/project-2/" />
<meta property="article:published_time" content="2022-12-08T10:58:08-04:00" />
<meta property="article:modified_time" content="2022-12-08T10:58:08-04:00" /><meta property="og:site_name" content="Murad Farhan" />
<meta itemprop="name" content="Project 2:Profiling and Analyzing the Yelp Dataset With SQL">
<meta itemprop="description" content="Data Scientist Role Play: Profiling and Analyzing the Yelp Dataset">
<meta itemprop="datePublished" content="2022-12-08T10:58:08-04:00" />
<meta itemprop="dateModified" content="2022-12-08T10:58:08-04:00" />
<meta itemprop="wordCount" content="2464">



<meta itemprop="keywords" content="SQL Projects," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Project 2:Profiling and Analyzing the Yelp Dataset With SQL"/>
<meta name="twitter:description" content="Data Scientist Role Play: Profiling and Analyzing the Yelp Dataset"/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  
  <header class="cover bg-top" style="background-image: url('https://da-murad.github.io/Murad-Portfolio/images/SQL%20Project.png');">
    <div class="bg-black-60">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://da-murad.github.io/Murad-Portfolio/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Murad Farhan
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://da-murad.github.io/Murad-Portfolio/about/" title="About page">
              About
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://da-murad.github.io/Murad-Portfolio/contact/" title="Contact page">
              Contact
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://da-murad.github.io/Murad-Portfolio/post/" title="Projects page">
              Projects
            </a>
          </li>
          
        </ul>
      
      
<div class="ananke-socials">
  
    
    <a href="https://www.linkedin.com/in/murad-farhan-455a79220/" target="_blank" rel="noopener" class="linkedin ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" aria-label="follow on LinkedIn——Opens in a new window">
      
        <span class="icon"><svg style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span>
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
</div>

    </div>
  </div>
</nav>

      <div class="tc-l pv6 ph3 ph4-ns">
        
          <div class="f2 f1-l fw2 white-90 mb0 lh-title">Project 2:Profiling and Analyzing the Yelp Dataset With SQL</div>
          
            <div class="fw1 f5 f3-l white-80 measure-wide-l center lh-copy mt3 mb4">
              Data Scientist Role Play: Profiling and Analyzing the Yelp Dataset
            </div>
          
        
      </div>
    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        PROJECTS
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
      
      <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://da-murad.github.io/Murad-Portfolio/post/project-2/&amp;title=Project%202:Profiling%20and%20Analyzing%20the%20Yelp%20Dataset%20With%20SQL" class="ananke-social-link linkedin no-underline" aria-label="share on LinkedIn">
        
        <span class="icon"> <svg style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span>
        
      </a>
    
  </div>


      <h1 class="f1 athelas mt3 mb1">Project 2:Profiling and Analyzing the Yelp Dataset With SQL</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2022-12-08T10:58:08-04:00">December 8, 2022</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><h3 id="introduction">Introduction</h3>
<p>I will be using a dataset from a US-based organization called Yelp, which provides a platform for users to provide reviews and rate their interactions with a variety of organizations – businesses, restaurants, health clubs, hospitals, local governmental offices, charitable organizations, etc. Yelp has made a portion of this data available for personal, educational, and academic purposes.</p>
<p>I will perform profile and better understand the data in the first part of the case study. Once I have answered each question  regarding the data to help me, I will come up with my own question for analysis and will prepare a dataset for the analysis I choose to do in the second part of the Case Study.</p>
<h3 id="part-1-yelp-dataset-profiling-and-understanding">Part 1: Yelp Dataset Profiling and Understanding</h3>
<ul>
<li>Profile the data by finding the total number of records for each of the tables below:</li>
</ul>
<pre><code class="language-{r}" data-lang="{r}">SELECT count(*) AS 'Total Records'
FROM attribute --Name of the table

</code></pre><table>
<thead>
<tr>
<th>Result</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>i. Attribute table =</td>
<td>10000</td>
</tr>
<tr>
<td>ii. Business table =</td>
<td>10000</td>
</tr>
<tr>
<td>iii. Category table =</td>
<td>10000</td>
</tr>
<tr>
<td>iv. Checkin table =</td>
<td>10000</td>
</tr>
<tr>
<td>v. elite_years table=</td>
<td>10000</td>
</tr>
<tr>
<td>vi. friend table =</td>
<td>10000</td>
</tr>
<tr>
<td>vii. hours table =</td>
<td>10000</td>
</tr>
<tr>
<td>viii. photo table =</td>
<td>10000</td>
</tr>
<tr>
<td>ix. review table =</td>
<td>10000</td>
</tr>
<tr>
<td>x. tip table =</td>
<td>10000</td>
</tr>
<tr>
<td>xi. user table =</td>
<td>10000</td>
</tr>
</tbody>
</table>
<ul>
<li>Finding the total distinct records by either the foreign key or primary key for each table.
using the below SQL query</li>
</ul>
<pre><code class="language-{r}" data-lang="{r}">SELECT Count(DISTINCT (user_id))--Primary or foreign key
FROM friend -- Table Name
</code></pre><table>
<thead>
<tr>
<th>Result</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>i. Business=</td>
<td>10000</td>
</tr>
<tr>
<td>ii. Hours=</td>
<td>1562  (foreign key &lsquo;business_id&rsquo;)</td>
</tr>
<tr>
<td>iii. Category=</td>
<td>2643 (foreign key &lsquo;business_id&rsquo;)</td>
</tr>
<tr>
<td>iv. Attribute=</td>
<td>1115 (foreign key &lsquo;business_id&rsquo;)</td>
</tr>
<tr>
<td>v. Review=</td>
<td>10000</td>
</tr>
<tr>
<td>vi. Checkin=</td>
<td>493 (foreign key &lsquo;business_id&rsquo;)</td>
</tr>
<tr>
<td>vii. Photo=</td>
<td>10000</td>
</tr>
<tr>
<td>viii. Tip=</td>
<td>6493 (foreign key &lsquo;business_id&rsquo;)</td>
</tr>
<tr>
<td>ix. User=</td>
<td>10000</td>
</tr>
<tr>
<td>x. Friend=</td>
<td>11   (foreign key &lsquo;user_id&rsquo;)</td>
</tr>
<tr>
<td>xi. Elite_years=</td>
<td>2780 (foreign key &lsquo;user_id&rsquo;)</td>
</tr>
</tbody>
</table>
<ul>
<li>Checking if there is a Null values in the user Table  and there is not any Null values</li>
</ul>
<pre><code class="language-{r}" data-lang="{r}">SELECT *
FROM user
WHERE id = NULL
	OR name = NULL
	OR review_count = NULL
	OR yelping_since = NULL
	OR useful = NULL
	OR funny = NULL
	OR cool = NULL
	OR fans = NULL
	OR average_stars = NULL
	OR compliment_hot = NULL
	OR compliment_more = NULL
	OR compliment_profile = NULL
	OR compliment_cute = NULL
	OR compliment_list = NULL
	OR compliment_note = NULL
	OR compliment_plain = NULL
	OR compliment_cool = NULL
	OR compliment_funny = NULL
	OR compliment_writer = NULL
	OR compliment_photos = NULL;
</code></pre><ul>
<li>For some table and column I query the smallest (minimum), largest (maximum), and average (mean) value for the following fields stars and reviews</li>
</ul>
<pre><code class="language-{r}" data-lang="{r}">Select 
min(stars) As 'min', -- column name 
max(stars) As 'max',
AVG(stars) As 'Average'

from Review -- Table name
</code></pre><p>Result</p>
<pre><code>	i. Table: Review, Column: Stars
	
		min:		max:		avg:
		1		5		3.7082
	
	ii. Table: Business, Column: Stars
	
		min:		max:		avg:
		1.0		5.0		3.6549
	
	iii. Table: Tip, Column: Likes
	
		min:		max:		avg:
		0		2		0.0144
	
	iv. Table: Checkin, Column: Count
	
		min:		max:		avg:
		1		53		1.9414
	
	v. Table: User, Column: Review_count
	
		min:		max:		avg:
		0		2000		24.2995

</code></pre><ul>
<li>Listing  the cities with the most reviews in descending order</li>
</ul>
<pre><code>Select 
city,
Count(review_count) as 'Total of Reviews'
from business 
group by city
order by sum(review_count) DESC
</code></pre><p>Result</p>
<pre><code>
+-----------------+------------------+
| city            | Total of reviews |
+-----------------+------------------+
| Las Vegas       |             1561 |
| Phoenix         |             1001 |
| Toronto         |              985 |
| Scottsdale      |              497 |
| Charlotte       |              468 |
| Henderson       |              274 |
| Tempe           |              261 |
| Pittsburgh      |              353 |
| Montréal        |              337 |
| Chandler        |              232 |
| Mesa            |              304 |
| Gilbert         |              188 |
| Cleveland       |              189 |
| Madison         |              176 |
| Glendale        |              188 |
| Mississauga     |              150 |
| Edinburgh       |              239 |
| Peoria          |              105 |
| North Las Vegas |               70 |
| Markham         |               80 |
| Champaign       |               71 |
| Stuttgart       |              141 |
| Surprise        |               60 |
| Lakewood        |               32 |
| Goodyear        |               41 |
+-----------------+------------------+
(Output limit exceeded, 25 of 362 total rows shown)
</code></pre><ul>
<li>Finding the distribution of star ratings to the business in the following cities:</li>
</ul>
<p>i. Avon</p>
<pre><code>SELECT name
	,stars
	,review_count
FROM business
WHERE city = 'Avon';
</code></pre><p>Result</p>
<pre><code>+-----------------------------------------------+-------+--------------+
| name                                          | stars | review_count |
+-----------------------------------------------+-------+--------------+
| Helen &amp; Kal's                                 |   2.5 |            3 |
| Marc's                                        |   4.0 |            4 |
| Hoban Pest Control                            |   5.0 |            3 |
| Light Salon &amp; Spa                             |   3.5 |            7 |
| Portrait Innovations                          |   1.5 |           10 |
| Winking Lizard Tavern                         |   3.5 |           31 |
| Dervish Mediterranean &amp; Turkish Grill         |   4.5 |           31 |
| Mulligans Pub and Grill                       |   3.5 |           50 |
| Mr. Handyman of Cleveland's Northwest Suburbs |   2.5 |            3 |
| Cambria hotel &amp; suites Avon - Cleveland       |   4.0 |           17 |
+-----------------------------------------------+-------+--------------+
</code></pre><p>ii. Beachwood</p>
<pre><code>SELECT name
	,stars
	,review_count
FROM business
WHERE city = 'Beachwood';
</code></pre><p>Result</p>
<pre><code>+---------------------------------+-------+--------------+
| name                            | stars | review_count |
+---------------------------------+-------+--------------+
| Maltz Museum of Jewish Heritage |   3.0 |            8 |
| Charley's Grilled Subs          |   3.0 |            3 |
| Sixth &amp; Pine                    |   4.5 |           14 |
| Beechmont Country Club          |   5.0 |            6 |
| Hyde Park Prime Steakhouse      |   4.0 |           69 |
| Origins                         |   4.5 |            3 |
| Fyodor Bridal Atelier           |   5.0 |            4 |
| College Planning Network        |   2.0 |            8 |
| Lucky Brand Jeans               |   3.5 |            3 |
| American Eagle Outfitters       |   3.5 |            3 |
| Shaker Women's Wellness         |   5.0 |            6 |
| Avis Rent A Car                 |   2.5 |            3 |
| Cleveland Acupuncture           |   5.0 |            3 |
| Studio Mz                       |   5.0 |            4 |
+---------------------------------+-------+--------------+
</code></pre><ul>
<li>Find the top 3 users based on their total number of reviews:</li>
</ul>
<pre><code>SELECT name
	,sum(review_count) AS 'total'
FROM user
GROUP BY name
ORDER BY total DESC limit 3
</code></pre><p>Result</p>
<pre><code>+--------+-------+
| name   | total |
+--------+-------+
| Nicole |  2397 |
| Sara   |  2253 |
| Gerald |  2034 |
+--------+-------+	

</code></pre><ul>
<li>Finding if  posing more reviews has correlate with more fans?</li>
</ul>
<p>As table below illustrates, posing more reviews does not necessarily correlate with more fans.
For example, although, Gerald has posed the most reviews, he has fewer fans in comparison with Mimi.
Therefore, sorting the users in descending order based on their total number of reviews does not sort the fans in the same order, meaning that there is not a correlation between the total number of reviews and number of fans.</p>
<pre><code>SELECT name AS Name
	,fans AS Fans
	,review_count AS Review
FROM user
ORDER BY review_count DESC
</code></pre><p>Result</p>
<pre><code>
+-----------+------+--------+
| Name      | Fans | Review |
+-----------+------+--------+
| Gerald    |  253 |   2000 |
| Sara      |   50 |   1629 |
| Yuri      |   76 |   1339 |
| .Hon      |  101 |   1246 |
| William   |  126 |   1215 |
| Harald    |  311 |   1153 |
| eric      |   16 |   1116 |
| Roanna    |  104 |   1039 |
| Mimi      |  497 |    968 |
| Christine |  173 |    930 |
| Ed        |   38 |    904 |
| Nicole    |   43 |    864 |
| Fran      |  124 |    862 |
| Mark      |  115 |    861 |
| Christina |   85 |    842 |
| Dominic   |   37 |    836 |
| Lissa     |  120 |    834 |
| Lisa      |  159 |    813 |
| Alison    |   61 |    775 |
| Sui       |   78 |    754 |
| Tim       |   35 |    702 |
| L         |   10 |    696 |
| Angela    |  101 |    694 |
| Crissy    |   25 |    676 |
| Lyn       |   45 |    675 |
+-----------+------+--------+
</code></pre><ul>
<li>finding if  there are  more reviews with the word &ldquo;love&rdquo; or with the word &ldquo;hate&rdquo; in them?</li>
</ul>
<p>As the tables below show there are more reviews with the word love in them compared to the word hate.</p>
<pre><code>
Select 
count(*) AS 'No. of word love mentioned' 
from review 
where text like '%love%'

+----------------------------+
| No. of word love mentioned |
+----------------------------+
|                       1780 |
+----------------------------+


SELECT count(*) AS 'No. of word hate mentioned'
FROM review
WHERE TEXT LIKE '%hate%'

+----------------------------+
| No. of word hate mentioned |
+----------------------------+
|                        232 |
+----------------------------+
</code></pre><p>*Find the top 10 users with the most fans:</p>
<pre><code>SELECT name AS 'User Name'
	,fans AS 'No. of Fans'
FROM User
ORDER BY fans DESC limit 10

+-----------+-------------+
| User Name | No. of Fans |
+-----------+-------------+
| Amy       |         503 |
| Mimi      |         497 |
| Harald    |         311 |
| Gerald    |         253 |
| Christine |         173 |
| Lisa      |         159 |
| Cat       |         133 |
| William   |         126 |
| Fran      |         124 |
| Lissa     |         120 |
+-----------+-------------+
</code></pre><h4 id="part-2-inferences-and-analysis">Part 2: Inferences and Analysis</h4>
<p>I Picked one city and category of my choice and group the businesses in that city or category by their overall star rating.
Compare the businesses with 2-3 stars to the businesses with 4-5 stars and answer the following questions. Include your code.</p>
<p>I have picked restaurents category in las Vegas</p>
<pre><code>SELECT c.category AS 'category'
	,b.name AS 'busness name'
	,b.city AS 'business city'
	,b.stars AS 'Star rating'
	,h.hours AS 'Hours'
FROM business AS b
INNER JOIN category AS c ON b.id = c.business_id
INNER JOIN hours AS h ON b.id = h.business_id
WHERE b.city = 'Las Vegas'
GROUP BY b.stars
</code></pre><p>the  two groups I chose to analyze have a different distribution of hours</p>
<pre><code>SELECT c.category AS 'category'
	,b.name AS 'busness name'
	,b.city AS 'business city'
	,h.hours AS 'Hours'
FROM business AS b
inner JOIN category AS c ON b.id = c.business_id
inner JOIN hours AS h ON b.id = h.business_id
WHERE b.city = 'Las Vegas'
group by b.stars

+------------------+--------------------------------+---------------+---------------------+
| category         | busness name                   | business city | Hours               |
+------------------+--------------------------------+---------------+---------------------+
| Beauty &amp; Spas    | Walgreens                      | Las Vegas     | Saturday|8:00-22:00 |
| Restaurants      | Wingstop                       | Las Vegas     | Saturday|11:00-0:00 |
| Bars             | Hi Scores - Blue Diamond       | Las Vegas     | Saturday|0:00-0:00  |
| Health &amp; Medical | Anthem Pediatrics              | Las Vegas     | Saturday|8:00-12:00 |
| Active Life      | Red Rock Canyon Visitor Center | Las Vegas     | Saturday|8:00-16:30 |
| Shopping         | Desert Medical Equipment       | Las Vegas     | Monday|8:00-17:00   |
+------------------+--------------------------------+---------------+---------------------+
</code></pre><p>the two groups I chose to analyze have a different number of reviews</p>
<pre><code>SELECT 
    c.category AS 'category'
	,b.name AS 'busness name'
	,b.city AS 'business city'
	,b.stars AS 'Star rating'
	,h.hours AS 'Hours'
	,b.review_count AS 'no.reviews'
FROM (business AS b
inner JOIN category AS c ON b.id = c.business_id)
inner JOIN hours AS h ON b.id = h.business_id
WHERE b.city = 'Las Vegas'
group by b.stars

+------------------+--------------------------------+---------------+-------------+---------------------+------------+
| category         | busness name                   | business city | Star rating | Hours               | no.reviews |
+------------------+--------------------------------+---------------+-------------+---------------------+------------+
| Beauty &amp; Spas    | Walgreens                      | Las Vegas     |         2.5 | Saturday|8:00-22:00 |          6 |
| Restaurants      | Wingstop                       | Las Vegas     |         3.0 | Saturday|11:00-0:00 |        123 |
| Bars             | Hi Scores - Blue Diamond       | Las Vegas     |         3.5 | Saturday|0:00-0:00  |        105 |
| Health &amp; Medical | Anthem Pediatrics              | Las Vegas     |         4.0 | Saturday|8:00-12:00 |         16 |
| Active Life      | Red Rock Canyon Visitor Center | Las Vegas     |         4.5 | Saturday|8:00-16:30 |         32 |
| Shopping         | Desert Medical Equipment       | Las Vegas     |         5.0 | Monday|8:00-17:00   |          4 |
+------------------+--------------------------------+---------------+-------------+---------------------+------------+
</code></pre><p>Based on the results, we can see that there seems to be a correlation between the location of the business and their rating.
The business that are probably located in the same neighbor have close rating. Also they have similar working hours.
Moreover, the business that have longer working hours usually have higher rating.</p>
<pre><code>SELECT c.category AS 'category'
	,b.name AS 'busness name'
	,b.city AS 'business city'
	,b.stars AS 'Star rating'
	,h.hours AS 'Hours'
	,b.review_count AS 'no.reviews'
	,b.postal_code AS 'POSTAL CODE'
FROM (
	business AS b INNER JOIN category AS c ON b.id = c.business_id
	)
INNER JOIN hours AS h ON b.id = h.business_id
WHERE b.city = 'Las Vegas'
GROUP BY b.stars
</code></pre><p>i. Difference 1:
The business that are still open have higher rating than the closed ones</p>
<p>ii. Difference 2:
The business that are still open have less reviews  than the closed ones</p>
<pre><code>SELECT 
    c.category AS 'category'
	,b.name AS 'busness name'
	,b.city AS 'business city'
	,b.stars AS 'Star rating'
	,h.hours AS 'Hours'
	,b.review_count AS 'no.reviews'
    ,b.postal_code As 'POSTAL CODE'
    ,b.is_open AS 'Open or Close'
FROM (business AS b
inner JOIN category AS c ON b.id = c.business_id)
inner JOIN hours AS h ON b.id = h.business_id
WHERE b.city = 'Las Vegas'
group by is_open
</code></pre><p>I have to determine if there is a correlation between category and star rating within a city</p>
<p>I joined data from the business table with the categories table
to see if the a business category has a impact on stars in the city of Mesa .
I also pulled review_count and is_open as this factor may affect the analysis</p>
<pre><code>SELECT b.city
	,c.category
	,b.stars
	,b.review_count
	,b.is_open
FROM business b
LEFT JOIN category c ON b.id = c.business_id
WHERE b.city = 'Mesa'
GROUP BY c.category
ORDER BY b.stars DESC

Output of your finished dataset:

+------+-----------------------------+-------+--------------+---------+
| city | category                    | stars | review_count | is_open |
+------+-----------------------------+-------+--------------+---------+
| Mesa | Arabian                     |   5.0 |          267 |       1 |
| Mesa | Automotive                  |   5.0 |            4 |       1 |
| Mesa | Halal                       |   5.0 |          267 |       1 |
| Mesa | Mediterranean               |   5.0 |          267 |       1 |
| Mesa | Motorcycle Dealers          |   5.0 |            4 |       1 |
| Mesa | Restaurants                 |   5.0 |          267 |       1 |
| Mesa | Salad                       |   5.0 |          267 |       1 |
| Mesa | Sandwiches                  |   5.0 |          267 |       1 |
| Mesa | Cannabis Clinics            |   4.5 |           16 |       1 |
| Mesa | Health &amp; Medical            |   4.5 |           16 |       1 |
| Mesa | Bars                        |   4.0 |          129 |       0 |
| Mesa | Gluten-Free                 |   4.0 |          129 |       0 |
| Mesa | Italian                     |   4.0 |          129 |       0 |
| Mesa | Nightlife                   |   4.0 |          129 |       0 |
| Mesa | Pizza                       |   4.0 |          129 |       0 |
| Mesa | Check Cashing/Pay-day Loans |   3.0 |            4 |       1 |
| Mesa | Financial Services          |   3.0 |            4 |       1 |
| Mesa | None                        |   2.5 |           31 |       1 |
| Mesa | Local Services              |   2.0 |            3 |       0 |
| Mesa | Mobile Phone Accessories    |   2.0 |            3 |       0 |
| Mesa | Mobile Phones               |   2.0 |            3 |       0 |
| Mesa | Shopping                    |   2.0 |            3 |       0 |
+------+-----------------------------+-------+--------------+---------+  
</code></pre><ul class="pa0">
  
   <li class="list di">
     <a href="https://da-murad.github.io/Murad-Portfolio/tags/sql-projects/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">SQL Projects</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://da-murad.github.io/Murad-Portfolio/" >
    &copy;  Murad Farhan 2022 
  </a>
    <div>
<div class="ananke-socials">
  
    
    <a href="https://www.linkedin.com/in/murad-farhan-455a79220/" target="_blank" rel="noopener" class="linkedin ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" aria-label="follow on LinkedIn——Opens in a new window">
      
        <span class="icon"><svg style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span>
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
